BUG-ID: AUTH-SECURITY-002
SUMMARY:
API принимает SQL-инъекции в поле username при регистрации, создавая пользователей с потенциально опасными данными. Поле email корректно отклоняет SQL-инъекции, но username не имеет защиты от SQL-инъекций

ENVIRONMENT:
Local Docker nanoreddit
Endpoint: /api/v1/auth/register

PRECONDITIONS:
Нет

STEPS TO REPRODUCE:
1. Выполнить POST /api/v1/auth/register с телом, содержащим SQL-инъекцию в username:
{
  "email": "nicholashurley@example.org",
  "username": "1; DROP TABLE users;",
  "password": "#X0SlGb51BNG@",
  "passwordConfirmation": "#X0SlGb51BNG@"
}
2. Выполнить POST /api/v1/auth/register с другим SQL-инъекционным пейлоадом:
{
  "email": "david24@example.org",
  "username": "' OR '1'='1",
  "password": "#X0SlGb51BNG@",
  "passwordConfirmation": "#X0SlGb51BNG@"
}
3. Выполнить POST /api/v1/auth/register с третьим SQL-инъекционным пейлоадом:
{
  "email": "pamelawoods@example.com",
  "username": "\" OR \"\" = \"",
  "password": "#X0SlGb51BNG@",
  "passwordConfirmation": "#X0SlGb51BNG@"
}
4. Выполнить POST /api/v1/auth/register с четвертым SQL-инъекционным пейлоадом:
{
  "email": "whernandez@example.net",
  "username": "admin' --",
  "password": "#X0SlGb51BNG@",
  "passwordConfirmation": "#X0SlGb51BNG@"
}
5. Проверить базу данных на наличие созданных пользователей с SQL-инъекционными пейлоадами в username

EXPECTED RESULT:
- SQL-инъекционные пейлоады должны отклоняться валидацией как в email, так и в username
- API должен возвращать ошибку валидации при попытке использовать SQL-инъекции в username
- Пользователи с SQL-инъекционными пейлоадами в username не должны создаваться в базе данных

ACTUAL RESULT:
API успешно создает пользователей с SQL-инъекционными пейлоадами в username:
1; DROP TABLE users;
' OR '1'='1
" OR "" = "
admin' --
Пользователи реально создаются в базе данных с опасными данными в поле username
Поле email корректно отклоняет SQL-инъекции (валидация работает), но username не имеет такой защиты
При использовании неправильно сформированных SQL-запросов это может привести к SQL-инъекциям и потенциальному нарушению целостности базы данных

SEVERITY:
Critical

PRIORITY:
P1

NOTES:
Это критическая уязвимость безопасности. SQL-инъекции в username могут привести к выполнению произвольного SQL-кода, что может привести к:
Удалению данных (DROP TABLE)
Обходу аутентификации (OR '1'='1)
Извлечению чувствительных данных
Нарушению целостности базы данных
Необходимо:
Добавить валидацию, запрещающую SQL-специальные символы и конструкции в username
Убедиться, что все SQL-запросы используют параметризованные запросы (prepared statements)
Привести валидацию username к тому же уровню безопасности, что и для email
Провести аудит всех мест, где username используется в SQL-запросах
========================================